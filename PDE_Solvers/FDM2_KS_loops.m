function rhs_loop = FDM2_KS_loops(u, t, h)

rhs_loop = zeros(length(u),1);

for i = 3:(length(u(:,1))-2)
    
    rhs_loop(i) = -(u(i,1)/(2*h))*(u(i+1,1)-u(i-1,1)) - ...
                  (u(i-1,1)-2*u(i,1)+u(i+1,1))/(h^2) - ...
                  (u(i-2,1)-4*u(i-1,1)+6*u(i,1)-4*u(i+1,1)+u(i+2,1))/(h^4);
              
end


rhs_loop(2) = -(u(2,1)/(2*h))*(u(2+1,1)-u(2-1,1)) - ...
              (u(2-1,1)-2*u(2,1)+u(2+1,1))/(h^2) - ...
              (u(end,1)-4*u(2-1,1)+6*u(2,1)-4*u(2+1,1)+u(2+2,1))/(h^4);
          
rhs_loop(1) = -(u(1,1)/(2*h))*(u(1+1,1)-u(end,1)) - ...
              (u(end,1)-2*u(1,1)+u(1+1,1))/(h^2) - ...
              (u(end-1,1)-4*u(end,1)+6*u(1,1)-4*u(1+1,1)+u(1+2,1))/(h^4); 

rhs_loop(end-1) = -(u(end-1,1)/(2*h))*(u(end-1+1,1)-u(end-1-1,1)) - ...
                (u(end-1-1,1)-2*u(end-1,1)+u(end-1+1,1))/(h^2) - ...
                (u(end-1-2,1)-4*u(end-1-1,1)+6*u(end-1,1)-4*u(end-1+1,1)+u(1,1))/(h^4);  

          
rhs_loop(end) = -(u(end,1)/(2*h))*(u(1,1)-u(end-1,1)) - ...
              (u(end-1,1)-2*u(end,1)+u(1,1))/(h^2) - ...
              (u(end-2,1)-4*u(end-1,1)+6*u(end,1)-4*u(1,1)+u(2,1))/(h^4);  


end         
          